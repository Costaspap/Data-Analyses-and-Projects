---
title: "Workable Coin Toss Puzzle Solution"
author: "Konstantinos Papastamos"
date: "6 June 2016"
output: pdf_document
---

The Puzzle:

Suppose	we	have	4	coins,	each	with	a	different	probability	of	throwing	Heads.	An	
unseen	hand	chooses	a	coin	at	random	and	flips	it	50	times.	This	experiment	is	
done	several	times	with	the	resulting	sequences	as	shown	below	(H	=	Heads,	T	=	
Tails)	Write	a	program	that	will	take	as	input	the	data	that	is	collected	from	this	
experiment	and	estimate	the	probability	of	heads	for	each	coin.	

My Solution:

I did one change before I load the data, I deleted the blank lines
in the original dataset, I will attach my data.txt with the e-mail.
It also can be found in my github repository in this link: 
https://github.com/Costaspap/Workable_Coin_Toss_Puzzle

Important: Make sure that the data.txt file is in
R's current working directory, found with the getwd() command.

So in order to get started, we first load the data. 
We don't have headers and we don't want strings to be
stored as factors, so:

```{r}
data = read.table("data.txt", header = F, strin = F)
names(data) = "Tosses"
```

Lets make sure every row has 50 characters.

```{r}
lapply(data,nchar)
```

We only want to keep the head occurences.

```{r}
heads = sapply(data,function(x) gsub("T","",x))
```

Then we find the number of heads.

```{r}
nheads = apply(heads,2,nchar)
```

Find the head propability for each experiment.

```{r}
headprop = nheads/50
```

Let's make them look nice

```{r}
headprop = sort(headprop)
```

Now let's take a look at our data:

```{r}
hist(headprop,col="red")
```

I am going to use k-means clustering. I chose the initial centers
based on the histogram.

```{r}
k=kmeans(headprop,c(0.23,0.35,0.48,0.8),iter.max=10)
k
```


===========================================Results============================================================

So my best estimates for each coin's head propability are:

Coin 1:  0.2388889
Coin 2:  0.3472000
Coin 3:  0.5026667
Coin 4:  0.8058824

After experimenting with many different centers, those gave me the
highest reduction in sum of squares, 95,7%